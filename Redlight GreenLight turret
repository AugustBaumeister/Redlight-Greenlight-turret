#include <Servo.h>

const int redLEDPin = 2;
const int greenLEDPin = 3;
const int motionSensorPin = 4;
const int rollServoPin = 9; 

const int startupLightDuration = 5000; 
const int countdownBlinkDuration = 3000; 
const int blinkInterval = 1000; 
const int blinkOnTime = 750; 

const int fireDuration = 3000; 
const int rollSpeed = 0; 

Servo rollServo;

void setup() {
  Serial.begin(9600);

  pinMode(redLEDPin, OUTPUT);
  pinMode(greenLEDPin, OUTPUT);
  pinMode(motionSensorPin, INPUT);
rollServo.attach(rollServoPin);
  delay(100); 
  rollServo.write(90); 

  
  digitalWrite(redLEDPin, HIGH);
  digitalWrite(greenLEDPin, HIGH);
  delay(startupLightDuration);

  
  for (int i = 0; i < countdownBlinkDuration / blinkInterval; i++) {
    digitalWrite(redLEDPin, HIGH);
    digitalWrite(greenLEDPin, HIGH);
    delay(blinkOnTime);
    digitalWrite(redLEDPin, LOW);
    digitalWrite(greenLEDPin, LOW);
    delay(blinkInterval - blinkOnTime);
  }

  Serial.println("Game Start!");
}

void loop() {
  int greenDuration = random(3000, 7000); 
  int redDuration = random(3000, 7000);   

  
  digitalWrite(greenLEDPin, HIGH);
  digitalWrite(redLEDPin, LOW);
  Serial.println("GREEN LIGHT - Player can move");
  delay(greenDuration);

  
  digitalWrite(greenLEDPin, LOW);
  digitalWrite(redLEDPin, HIGH);
  Serial.println("RED LIGHT - Motion detection active");

  
  unsigned long startTime = millis();
  while (millis() - startTime < redDuration) {
    if (digitalRead(motionSensorPin) == HIGH) {
      Serial.println("MOTION DETECTED - FIRING!");
      fireRollServo();
      break;
    }
    delay(10); 
  }

  
  digitalWrite(redLEDPin, LOW);
  delay(500); 
}


void fireRollServo() {
  Serial.println("Inside fireRollServo()");
  rollServo.write(rollSpeed); 
  delay(fireDuration);
  rollServo.write(90); 
  Serial.println("Servo should have moved");
}

